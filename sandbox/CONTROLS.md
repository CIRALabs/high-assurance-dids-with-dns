# DID:WEB Technical Controls and Levels of Security Assurance

This section defines a simple framework to define a set of technical controls that can be implemented as groups of controls mapped into levels of security assurance for did:web identifiers which then can be mapped to trust framework assurance leves.

## Security Assurance

Security assurance is distinct from trust assurance. In the context of assuring did:web identifiers, security assurance refers to the implementation and level of confidence that security measures, practices, and policies are in place effectively protect the data, systems, and networks of an organization. It involves ensuring that the security controls are functioning correctly and are adequate to mitigate identified risks.

To assist in decision-making and implementation, The controls are ordered in increasing level of [security assurance](#security-assurance) and are grouped into levels of assurance from **LOW-** to **HIGH+**

- **Issuing Authority** is the entity accountable for the did:web identifier.
- **Issuing Service** is the entity responsible for operating the did:web identifier insfrastructure.

In many cases the **Issuing Authority** may delegate elements of providing a high assurance did:web identitifier to an **Issuing Service** that may be a commercial provider.

In the simplest case, the **Issuing Authority** can be regarded as the same as the **Issuing Service**.

Note that Controls 9, 10, and 11 CANNOT BE DELEGATED to an **Issuing Service**

## Controls

11 technical controls are defined. These controls would be implemented in order of precedence for an increasing level of security assurance. (e.g., Control No. N would need to be implemented before implementing Control No. N+1)

|Control No.|Control Name|Description|
|--|---|---|
|1|DID Resource Control|The Issuing Service MUST control the resource that generates the DID document. (i.e., website)|
|2|DID Document Management|The Issuing Service MUST have the ability to do [CRUD](#crud) operations on the DID document.|
|3|DID Document Data Integrity|The Issuing Service MUST ensure the data integrity of the DID document by cryptographic means, typically a digital signature or [other means](#other-means). The use of approved or established [cryptographic algorithms](#cryptographic-algorithms) is HIGHLY RECOMMENDED|
|4|DID Document Key Control|The Issuing Service MUST control the keys required to sign the DID document.|
|5|DID Document Key Generation|With proper delegation from the Issuing Authority, the DID Document signing key MAY be generated by the Issuing Service. Otherwise, the signing key must be generated by the Issuing Authority.|
|6|Domain Zone Control|The Issuing Service MUST have control of the domain zone (or subdomain zone).If direct control of the domain is not feasible, the use of an accredited DNS provider is HIGHLY RECOMMENDED|
|7|Domain Zone Mapping|There MUST be domain zone records that map the necessary URI, TLSA, CERT and/or TXT records to the specified did:web identifier.|
|8|Domain Zone Signing|The domain zone records MUST be signed according to DNSSEC. (RRSIG)|
|9|Domain Zone Signing Key Control|The Issuing Authority MUST have control over the domain zone keys used for signing and delegation. (KSK and ZSK)|
|10|Domain Zone Signing Key Generation|The signing keys MUST be generated under the control of the Issuing Authority.|
|11|Hardware Security Module|A FIPS 140-2 compliant hardware security module must be under the control of the Issuing Authority.|

## Levels of Security Assurance

Many trust frameworks specify levels of assurance to assist in determing which controls must be implemented.

The following table defines levels of securiy assurance that can be mapped to trust framework levels of assurance. Mapping to trust framework assurance levels is out of scope for this exercise but can be used to assist in determing mappings by grouping the controls within a range from **LOW-** to **HIGH+** relating to the appropriate risk level. Note that controls are additive)in nature. (i.e.,, controls of the preceding level must be fulfilled).

|Level of Security Assurance|Controls|Description|
|---|---|---|
|**LOW-**| Control 1|SHOULD only be used for low risk transactions where attribution to originator is desireable.|
|**LOW**|Control 2|SHOULD only be used for lower risk transactions where establishing the accountablity of the originator is desirable.|
|**MEDIUM**|Controls 3, 4 and 5|MAY be used for medium risk commercial transactions, such as correspondence, proposals, etc.|
|**MEDIUM+**| Controls 6 and 7|MAY be used for higher risk transcations, such as signing and verifying invoices, contracts, or official/legal docmentation|
|**HIGH**| Controls 8, 9 and 10|MUST be high risk transactions, such as government transactions for signing and verifying licenses, certifications or identification|
|**HIGH+**| Control 11|MUST be used for extremely high risk transactions where there may be systemic or national security implications|

### CRUD

Crud is defined as: Create, Read, Update, Delete/Deactivate



### Other Means

Other means include: 

- message authentication code (MAC), 
- hashes
- other cryptographic techniques

Can also include the use of community-driven specification of suites:

- [W3C Data Integrity 1.0](https://www.w3.org/community/reports/credentials/CG-FINAL-data-integrity-20220722/)


### Cryptographic Algorithms

Includes curves and algorithms that operate on these curves

- RSA
- NIST Approved Curves
- SECP Curves
- Pairing Curves
- Signing Algorithms: ECDSA, Schnorr
